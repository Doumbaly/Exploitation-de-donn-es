
/*------- EXERCICE1:EXPLOITATION DES DONNEES------------*/

DM "CLEAR LOG ; CLEAR OUTPUT ; " ;
DM 'next VIEWTABLE:; end;'; *Closes all opened viewtable windows;
DM 'odsresults' clear ; * Clears the Results window;
ods html close ;
ods html ;
/*Question 1*/

Libname Projet 'C:\Users\doums\Desktop\cours Vannes\Lardjane\Projets'; 
FILENAME DONTXT 'C:\Users\doums\Desktop\cours Vannes\Lardjane\Projets\dd.txt';
* Lecture d'un fichier xls ;
PROC IMPORT DATAFILE = DONTXT OUT = Projet.dd 
DBMS = csv ;delimiter=";"
getnames=yes 
;
run;
PROC PRINT DATA = Projet.dd /*noobs*/ ;
run ;

/*Question 2*/

proc means DATA=Projet.dd;
run;

proc format;
value pdiff 1='NON'
            2='OUI';
value pSTATUS 1='Individuel'
            0='Entreprise';
value pToF 1='Elevage'
            2='Cereales'
            3='mix'
            4='Autres'
            5='Autres'
            6='Autres';
value pOWNLAND 
            1='Proprietaire'
            0='Non Proprietaire';
value pCNTY 
27='Eure'
59='Nord'
61='Orne'
76='Seine-Maritime';
run;

data projet.dd1;
set projet.dd;
format DIFF pdiff. STATUS pSTATUS. ToF pToF. OWNLAND POWNLAND. CNTY pcnty.;
run;

/*------Analyse des exploitations étudiées------ */

/*-QUESTION 3*/

proc PRINT DATA=projet.Dd1;
var CNTY;
run;

/*QUESTION 4*/
/*--nombre d'exploitant*/
proc means DATA=projet.Dd1 max;
Var Num;
run;
/*pourcentage en defaut de paiement*/
proc freq DATA=projet.Dd1;
table DIFF;
run;

/*pourcentage des proprietaire de leur exploitation*/
proc freq DATA=projet.Dd1;
table OWNLAND;
run;

/*QUESTION 5*/
/*-----------Representation de la repartition de l'age des exploitants--------------*/
title "Representation de la repartition de l'age des exploitants";
footnote j=r "Age";

proc gchart data=projet.Dd1;
vbar3d AGE;
hbar3d Num; 
run;
quit;
/*AGE MOYEN-min-max-median*/
proc means data=projet.dd1;
var AGE;
run;

proc univariate data=projet.dd1;
var AGE;
run;

/*QUESTION 6*/
/*-------Représentation de la répartition des surfaces d’exploitation---------*/
title "Représentation de la répartition des surfaces d’exploitation";
footnote j=r "Age";

proc gchart data=projet.Dd1;
vbar3d HECTARE; 
hbar3d Num;
run;
quit;

proc means data=projet.dd1;
var HECTARE;
run;

proc univariate data=projet.dd1;
var HECTARE;
run;
/*A quels département appartiennent les 10 exploitations les plus importantes ? */
title "Représentation de la répartition des surfaces d’exploitation en fonction des departement";
footnote j=r "exploitation";
proc tabulate data=projet.dd1;
class CNTY HECTARE;
table CNTY HECTARE;
by CNTY;
run;

proc tabulate data=projet.dd1;
class CNTY HECTARE DIFF;
table CNTY DIFF,HECTARE ;
by CNTY;
run;
quit;

/*QUESTION7*/

proc freq data=projet.dd1;
table ToF;
run;
/*QUESTION 8*/
/*------repartition des surfaces par departement-----*/
proc tabulate data=projet.dd1;
class HECTARE CNTY;
table HECTARE CNTY;
by CNTY;
run;

/*QUESTION 9*/
proc means data=projet.dd1 ;
class HECTARE CNTY;
var HECTARE CNTY;
by CNTY;
run;
proc freq data=projet.dd1 ;
table HECTARE CNTY;
by CNTY;
run;
/*QUESTION 10*/
proc tabulation data=projet.dd1;
class HECTARE STATUS;
table HECTARE STATUS;
by CNTY;
run;
proc means data=projet.dd1;
var HECTARE STATUS;
by CNTY;
run;

/*QUESTION 11*/

proc tabulation data=projet.dd1;
class CNTY ToF;
table CNTY ToF;
by CNTY;
run;

proc gchart data=projet.Dd1;
vbar3d CNTY; 
hbar3d Tof;
run;
quit;

proc gchart data=projet.dd1;
pie3d ToF HECTARE/discrete; 
run;
quit;

/*QUESTION 12*/
proc tabulate data=projet.dd1;
class OWNLAND HECTARE;
table OWNLAND HECTARE;
run;
proc tabulate data=projet.dd1;
class OWNLAND hectare;
var age;
table ownland hectare,age*(Min MEAN MEDIAN);
run;

/*QUESTION 13*/
proc gchart data=projet.Dd1;
vbar3d HECTARE; 
hbar3d DIFF;
run;
quit;

/*QUESTION 14*/

proc tabulate data=projet.dd1;
class DIFF CNTY;
table DIFF CNTY;
by CNTY;
run;
data projet.cndif(keep=DIFF CNTY);
set projet.dd1 ;
run;

proc format;
picture pctfmt(round)0-high='00%';
run;


proc gchart data=projet.cndif;
vbar DIFF; 
hbar CNTY;
run;
quit;

proc gchart data=projet.cndif;
pie3d cnty/sumvar=diff woutline=2 coutline=black discrete;
run;
quit;



/**********EXERCICE2:SERIES TEMPORELLES********************/


DM "CLEAR LOG ; CLEAR OUTPUT ; " ;
DM 'next VIEWTABLE:; end;'; *Closes all opened viewtable windows;
DM 'odsresults' clear ; * Clears the Results window;
ods html close ;
ods html ;

FILENAME DONTXT 'C:\Users\doums\Desktop\bonipi.txt';
* Lecture d'un fichier txt ;
PROC IMPORT DATAFILE = DONTXT OUT = Projet.ipi 
DBMS=tab;
getnames=yes;
run;

* Ecriture dans un fichier texte;
DATA projet.indice ; set projet.ipi; drop mois; 
FILE DONTXT ;
put janv fev mars avr mai juin juil aout sept oct nov dec ; 
run;

DATA projet.data ;
INFILE DONTXT ;
INPUT zt @@ ;
date = intnx('month', '1jan1999'd,_n_-1) ;
format date monyy7. ; *ddmmyy8. ;
   symbol1
        interpol=join /*none*/
        value='dot'
        color=green
        height=0;
run ;

proc gplot data = projet.data; 
      plot ZT* date ;
	  symbol1 
        interpol=join /*none*/
        value='dot'
        color=green
        height=0;
run;
quit;
/*test de stationarite*/
%dftest( projet.data, zt, ar=6 );
   %put p=&dftest;
   /*ou*/
   ods output stationaritytests=StationarityTests ;
PROC ARIMA DATA=projet.data ;
	IDENTIFY 
		VAR=zt	 
		STATIONARITY=(ADF=(0,1,2) DLAG=1) 
		; 
RUN;QUIT;

proc arima data=projet.data ;
      identify var=ZT(1,12) /*center*/ nlag=30;
      estimate q=(12)(1) p=(12)(2) /*noconstant*/ method=ml /*uls*/;
forecast out=Projet.prev lead=12 back=0 id=date interval=month ;*noprint; 
run;
quit;








